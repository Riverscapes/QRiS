---
title: Analyses
sidebar_position: 11
description: Calculating river health metrics over time
---

QRiS analyses help track river health over time. Before you can perform an analysis you need to have a project with the following:

- One or more [data capture events](/software-help/dce) that represent the points in time for which you want to measure riverscape health. These events represent past, present or future representations of your riverscape captured as assessments, designs, plans or monitoring events. Each event must have geospatial features digitized (for automatic metric calculations). Manual entry of metric values do not require features to be digitized. 
- A [sample frame](/software-help/sample-frames) that subdivides your riverscape into the spatial units for which you want to report river health. Typically these are polygons that span valley wall to valley wall and represent the river reaches or sub-reaches. 

:::note
 If multiple, spatially separate, reaches exist in a project multiple analyses will need to be done. Each reach will have its own distinct centerline which is used for calculating metrics, so it is necessary that they be analyzed separately.
:::

![sample frame example](/images/software-help/analyses/separate-reaches.png)

## Creating an analysis

Right click on the **Analyses** folder in the QRiS project tree and select **New Analysis**. This will open the analysis properties form. Provide a name and description for the analysis. Select the Analysis Masks (sample frame), valley bottom, centerline, and DEM (optional) you want to use for the analysis. You cannot change this once the analysis has been created. If you make a mistake you will need to delete the analysis and start again.

:::note
It is possible to choose an AOI or Riverscapes polygon as your Analysis Mask (sample frame).
:::

Pick from the list of available [metrics](/software-help/metrics) that you want to include in your analysis. You can always add or remove metrics later. Each of the available metrics can have one of three states:

- **Exclude** - the metric will not be included in the analysis
- **Metric** - the metric will be included and treated as detailed metric when users want to dig into the full details of the analysis.
- **Indicator** - the metric will be included and treated as an indicator. Indicators are considered summary values, or shortlisted metrics for overall reporting.

Click **OK** to create the analysis.

![analysis properties form](/images/software-help/analyses/create-analysis.png)

:::tip
The question mark button next to each metric will pull up metadata associated with that metric. This is important if you are using multiple protocols in a given project, as this will indicate which protocol that metric belongs to.
:::

![metric details](/images/software-help/analyses/metric-info.png)

## Open An Analysis

Right click on an analysis in the QRiS project tree and select **Open**. This will open the analysis dockable window. You can reposition this window by dragging the title bar to suite your needs.

The analysis dockable window has the following features:

### Analysis Name

The analysis name is shown at the top and can be edited by clicking the **Properties** button.

### Data Capture Event

The currently selected data capture event can be changed using the dropdown list. The metric table below will update to show the metric values for the currently selected event.

### Mask Polygon

The currently selected sample frame polygon can be changed using the dropdown list. The metric table below will update to show the metric values for the currently selected polygon.

### Display Values 

Switch between showing just indicators (summary metrics) or all metrics using the two radio buttons.

### Units

Clicking this will open a window where you can change the units that calculations are displayed in.

### Metric Table

The metric table always reflects the currently selected data capture event and sample frame polygon. The table shows the metric values for each [metric](/software-help/metrics). The table can be sorted by clicking on the column headers. Click **Properties** to change which metrics and indicators are displayed.

The value column shows each individual metric value. The status column indicates whether the value displayed is a manually entered value or one that was calculated by QRiS by analysing the data capture event geospatial data within the current sample frame polygon. The status column can have one of the following values:

- Solid blue circle - a manual value exists for this metric.
- Solid blue square - a manual value exists and is the active value for this metric.
- hollow blue circle - no manual value exists for this metric.
- solid organge circle - an automated value exists for this metric.
- solid orange square - an automated value exists and is the active value for this metric.
- hollow orange circle - no automated value exists for this metric.

The uncertainty column shows the uncertainty associated with the current value. This is never automated and can only be entered manually. Uncertainty may be applicable when entering manual values based on ocular estimates within the sample frame.  

![analysis dockable window](/images/software-help/analyses/analysis-dockable-window.png)

### Calculate Metric Values

Click the calculate button to open a new window with the following options:

#### Data Capture Events

- **Just the currently active DCE** - only calculate values for the DCE selected in the anlalysis window
- **All data capture events** - calculate values for all DCEs, not just the one selected in the analysis window

#### Sample Frames

- **Just the currently active SF** - only calculate values for the sample frame selected in the analysis window
- **All Sample Frames** - Calculate values for all sample frames, not just the one selected in the analysis window

:::tip
Selecting all in both cases is an easy way to calculate all metrics across all sample frames and DCEs. Calculating just the currently active is a good way to run calculations to test output values and troubleshoot possible failed calculations.
:::

#### Metric Values

- **Overwrite any existing automated values** - selecting this will overwrite and automated values that already exist. This may be necessary if you made changes to your spatial data.
- **Force automated values to be active values** - selecting this makes the automated value the displayed/active value in the metirc table if you also entered in a manual value.

Click **OK** to calculate metrics.

![calculate window](/images/software-help/analyses/calculate.png)

### Manually Entering Metric Values

Double clicking a metric value cell or clicking the pencil logo in the analysis dockable window opens a form for entering the value.

- Click the Help icon to get information about currently selected metric. This is the same info that is accessible from the metric table when creating an analysis or editing the properties of an analysis.
- Enter the metric value in the text box.
- Pick how you want to define the uncertainty associated with the value you have chosen and provide the associated value, or range of values.
- Clicking the **Calculate** button will attempt to automate the calculation of the metric value using the geospatial data associated with the current data capture event and sample frame polygon. If the calculation is successful the value will be shown in the text box.
- Provide any contextual information about the metric value in the description text box.
- Add any metadata key/value pairs if there are any pertinent data regarding the metric value.

Click **OK** to save the metric value and return to the analysis dockable window.

![metric value form](/images/software-help/analyses/metric-value.png)

## Analysis Summary

Clicking the blue logo next to properties will open a new window where you can see your calculated metrics displayed as a graph. This is also accessible by right clicking on the analysis folder in the main QRIS project tree.

- The Analyis dropdown lets you choose which analysis you want to look at if multiple exist.
- The Analysis Type allows you to choose to visualize your metric two ways
    - **Metric over Time** - this will show metric values for chosen sample frame over the timespan from each DCE.
    - **Metric over Riverscape** - this will show your metric values from one individual DCE changing from one sample frame to another, or longitudinally through your riverscape. 
- The Metric dropdown allows you to choose the metric you would like to visualize.
- The Event dropdown allows you to switch between DCEs, this is only applicable when Metric over Riverscape is chosen.
- The Sample Frame Feature dropdown allows you to switch betwewn sample frames, this is only applicable when Metric over Time is chosen.

![metric over time](/images/software-help/analyses/metric-over-time.png)

![metric over riverscape](/images/software-help/analyses/metric-over-riverscape.png)

## Export an Analysis

Right click on an analysis in the QRiS project tree and select **Export Metrics Table**. Pick the desired file format and then specify a file location. Click **OK** to export the analysis. All metric values for all data capture events and sample frame polygons will be exported to the specified format.

## Delete an Analysis

Right click on an analysis in the QRiS project tree and select **Delete**. This will delete the analysis and all of its metric values. You cannot undo this action.
